UPDATE INPT_STORE_DISTRO ISD

   SET (STORE_DEPT, MERCH_GROUP, MERCH_TYPE) =

       (SELECT COALESCE(ISD.STORE_DEPT, IM.STORE_DEPT),

               COALESCE(ISD.MERCH_GROUP, IM.MERCH_GROUP),

               COALESCE(ISD.MERCH_TYPE, IM.MERCH_TYPE)

          FROM ITEM_MASTER IM

         WHERE IM.CD_MASTER_ID = :B5

           AND ISD.CO = :B3

           AND ISD.DIV = :B2

           AND IM.SKU_ID = ISD.SKU_ID),

       SKU_SUB_CODE_ID = COALESCE(SKU_SUB_CODE_ID, '*'),

       SKU_SUB_CODE_VALUE = COALESCE(SKU_SUB_CODE_VALUE, '*'),

       FRT_TERMS = COALESCE(FRT_TERMS, '0')

 WHERE ISD.WHSE = :B4

   AND ISD.CO = :B3

   AND ISD.DIV = :B2

   AND ISD.PROC_STAT_CODE = :B1

   AND ISD.SKU_ID IS NOT NULL

   AND EXISTS (SELECT 1

          FROM ITEM_MASTER IM2

         WHERE IM2.CD_MASTER_ID = :B5

           AND ISD.CO = :B3

           AND ISD.DIV = :B2

           AND IM2.SKU_ID = ISD.SKU_ID)

